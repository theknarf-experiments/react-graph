{"version":3,"sources":["components/graph.tsx","app.tsx","index.tsx"],"names":["ActionType","initialState","nodes","edges","GraphContext","createContext","ref","current","graphReducer","state","action","type","UpdatePosition","newState","index","findIndex","node","uid","push","x","y","UpdateAttribute","AddEdge","Node","children","useContext","getPosition","dispatch","onDragDone","useState","dragging","initial","setDragging","onMouseMove","e","clientX","clientY","onMouseUp","useEffect","currentRef","addEventListener","removeEventListener","dragged","onMouseDown","useDraggable","updatePosition","left","top","style","position","background","userSelect","useNode","useUID","args","GraphComponent","width","height","useRef","useReducer","Provider","value","find","backgroundColor","color","overflow","GenericNode1","padding","GenericNode2","App","num","setNum","repeat","split","map","_","i","onClick","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.69956cbd.chunk.js","sourcesContent":["import React, { createContext, useContext, useReducer, useState, useRef, useEffect } from 'react';\nimport { useUID } from 'react-uid';\n\ninterface Graph {\n\tnodes: any[];\n\tedges: any[];\n}\n\nconst initialState : Graph = {\n\tnodes: [],\n\tedges: [],\n}\n\nconst GraphContext = createContext<{\n\tstate?: Graph;\n\tdispatch?: Function;\n\tgetPosition?: Function;\n\tref: { current: any };\n}>({\n\tref: { current: null }\n});\n\nenum ActionType {\n\tUpdatePosition,\n\tUpdateAttribute,\n\tAddEdge,\n\tRemoveEdge,\n};\n\ntype Uid = string;\n\ntype Actions =\n | { type: ActionType.UpdatePosition, uid: Uid, x: Number, y: Number }\n | { type: ActionType.UpdateAttribute, uid: Uid, key: String, value: any }\n | { type: ActionType.AddEdge, fromNode: Uid, toNode: Uid };\n\nconst graphReducer = (state : Graph, action: Actions) => {\n\tswitch(action.type) {\n\t\tcase ActionType.UpdatePosition:\n\t\t\tconst newState = { ...state };\n\t\t\tconst index = state.nodes.findIndex((node) => node.uid === action.uid);\n\t\t\tif(index === -1) {\n\t\t\t\tnewState.nodes.push({uid: action.uid, x: action.x, y: action.y});\n\t\t\t} else {\n\t\t\t\tnewState.nodes[index].x = action.x;\n\t\t\t\tnewState.nodes[index].y = action.y;\n\t\t\t}\n\t\t\treturn newState;\n\t\tcase ActionType.UpdateAttribute:\n\t\tcase ActionType.AddEdge:\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn state;\n};\n\nconst updatePosition = (uid: Uid, x: Number, y: Number) => ({ type: ActionType.UpdatePosition, uid, x, y });\n\ninterface GraphComponentProps {\n\twidth: Number,\n\theight: Number,\n}\n\nconst GraphComponent : React.FC<GraphComponentProps> = ({ children, width, height }) => {\n\tconst ref = useRef(null);\n\tconst [state, dispatch] = useReducer(graphReducer, initialState);\n\tconst getPosition = (uid: Uid) => {\n\t\tconst node = state.nodes.find((node) => node.uid === uid);\n\t\tconst defaultValues = { x: 0, y: 0 };\n\t\treturn { ...defaultValues, ...node };\n\t}\n\n\treturn <GraphContext.Provider value={{\n\t\tstate,\n\t\tdispatch,\n\t\tgetPosition,\n\t\tref,\n\t}}>\n\t\t<div style={{\n\t\t\twidth: `${width}px`,\n\t\t\theight: `${height}px`,\n\t\t\tbackgroundColor: 'darkblue',\n\t\t\tcolor: '#eaeaea',\n\t\t\tposition: 'relative',\n\t\t\toverflow: 'hidden',\n\t\t}}\n\t\tref={ref}\n\t\t>\n\t\t{children}\n\t\t</div>\n\t</GraphContext.Provider>\n};\n\ninterface NodeProps {\n\tuid: Uid\n}\n\nconst useDraggable = (ref: { current: any }, onDragDone : Function) => {\n\tconst [dragging, setDragging ] = useState({\n\t\tdragging: false,\n\t\tinitial: { x: 0, y: 0 },\n\t\tcurrent: { x: 0, y: 0 },\n\t});\n\tconst onMouseDown = (e : React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n\t\tsetDragging({\n\t\t\tdragging: true,\n\t\t\tinitial: {\n\t\t\t\tx: e.clientX,\n\t\t\t\ty: e.clientY,\n\t\t\t},\n\t\t\tcurrent: {\n\t\t\t\tx: e.clientX,\n\t\t\t\ty: e.clientY,\n\t\t\t}\n\t\t})\n\t};\n\tconst onMouseMove = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n\t\tif(dragging.dragging) {\n\t\t\tsetDragging({\n\t\t\t\t...dragging,\n\t\t\t\tcurrent: {\n\t\t\t\t\tx: e.clientX,\n\t\t\t\t\ty: e.clientY,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\tconst onMouseUp = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n\t\tif(dragging.dragging) {\n\t\t\tonDragDone();\n\t\t\tsetDragging({\n\t\t\t\tdragging: false,\n\t\t\t\tinitial: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t},\n\t\t\t\tcurrent: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tvar currentRef : any = null;\n\t\tif(ref.current) {\n\t\t\tcurrentRef = ref.current;\n\t\t\tcurrentRef.addEventListener('mousemove', onMouseMove);\n\t\t\tcurrentRef.addEventListener('mouseup', onMouseUp);\n\t\t}\n\n\t\treturn () => {\n\t\t\tif(currentRef) {\n\t\t\t\tcurrentRef.removeEventListener('mousemove', onMouseMove);\n\t\t\t\tcurrentRef.removeEventListener('mouseup', onMouseUp);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst dragged = {\n\t\tx: dragging.current.x - dragging.initial.x,\n\t\ty: dragging.current.y - dragging.initial.y,\n\t}\n\n\treturn { dragged, onMouseDown };\n};\n\nconst Node : React.FC<NodeProps> = ({ children, uid }) => {\n\tconst { getPosition, dispatch, ref } = useContext(GraphContext);\n\tconst { x, y } = getPosition!(uid);\n\tconst { dragged, onMouseDown } = useDraggable(ref, () => {\n\t\tdispatch!(updatePosition(\n\t\t\tuid,\n\t\t\tx + dragged.x,\n\t\t\ty + dragged.y,\n\t\t));\n\t});\n\tconst left = x + dragged.x;\n\tconst top =  y + dragged.y;\n\n\treturn <div style={{\n\t\tposition: 'absolute',\n\t\tbackground: 'black',\n\t\tuserSelect: 'none',\n\t\tleft: `${left}px`,\n\t\ttop: `${top}px`,\n\t}}\n\tonMouseDown={onMouseDown}\n\t>\n\t\t<span>Uuid: {uid}</span>\n\t\t<div>{children}</div>\n\t</div>\n};\n\nexport const useNode = () => {\n\tconst uid = useUID();\n\t//const context = useContext(GraphContext);\n\n\treturn {\n\t\tNode: ({ ...args }) => <Node uid={uid} {...args} />,\n\t\t//setData: (key, value) => \n\t};\n}\n\nexport default GraphComponent;\n","import React, { useState } from 'react';\nimport Graph, { useNode } from './components/graph';\n\nconst GenericNode1 : React.FC = () => {\n\tconst { Node } = useNode();\t\n\n\treturn <Node>\n\t\t<div style={{ padding: '20px'}}>\n\t\tgeneric node type 1\t\n\t\t</div>\n\t</Node>\n}\n\nconst GenericNode2 : React.FC = () => {\n\tconst { Node } = useNode();\t\n\n\treturn <Node>\n\t\t<div style={{ padding: '20px'}}>\n\t\tgeneric node type 2\t\n\t\t</div>\n\t</Node>\n}\n\nconst App : React.FC = () => {\n\tconst [num, setNum] = useState(0);\n\tconst onClick = () => {\n\t\tsetNum(num + 1);\n\t};\n\n\treturn <div>\n\t\t<Graph width={1200} height={500}>\n\t\t\t<GenericNode1 />\n\t\t\t<GenericNode2 />\n\t\t\t{\n\t\t\t\t'.'.repeat(num).split('').map((_, i) => (\n\t\t\t\t\t<GenericNode2 key={i} />\n\t\t\t\t))\n\t\t\t}\n\t\t</Graph>\n\t\t<button onClick={onClick}>Add new</button>\n\t</div>\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './app';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}